<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[ä»é›¶å¼€å§‹ç©è½¬Protobufä¹‹ä¸€ - å‡†å¤‡å·¥ä½œ]]></title>
      <url>https://blog.ijita.me/2017/02/08/start_protobuf/</url>
      <content type="html"><![CDATA[<blockquote>
<p><strong><em>æœ¬ç³»åˆ—æ–‡ç« ç»Ÿä¸€ä½¿ç”¨JAVAå¹¶åœ¨MacOSä¸Šè¿›è¡Œæ¼”ç»ï¼Œå¦‚é‡é”™è¯¯è¯·æŒ‡å‡ºï¼ŒæœŸæœ›å…±åŒå­¦ä¹ è¿›æ­¥</em></strong></p>
</blockquote>
<h2 id="0x00-protobufç®€ä»‹">0x00 Protobufç®€ä»‹</h2>
<p>Protobufå…¨ç§°ä¸º<strong>Google Protocol Buffer</strong>ï¼Œå®ƒæ˜¯ä¸€ç§è½»ä¾¿é«˜æ•ˆçš„ç»“æ„åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œä¸»è¦ç”¨äºç»“æ„åŒ–æ•°æ®ä¸²è¡ŒåŒ–ï¼Œå¾ˆé€‚åˆåšæ•°æ®å­˜å‚¨æˆ–RPCæ•°æ®äº¤æ¢æ ¼å¼ï¼Œç›¸æ¯”XMLå®ƒæ›´å°æ›´å¿«æ›´ç®€å•ï¼Œå®ƒçš„å¤„ç†æ—¶é—´å¼€é”€ã€ç©ºé—´å¼€é”€æ›´å°ã€‚</p>
<p>é¦–æ¬¡ä½¿ç”¨æ—¶å®šä¹‰ä¸€ç§ç»“æ„åŒ–æ•°æ®çš„æ ¼å¼å³ <strong><em>.protoæ–‡ä»¶</em></strong> ï¼Œç„¶åä½¿ç”¨<strong><em>Protocol Compiler</em></strong>æ ¹æ®æ­¤ç»“æ„ç”Ÿæˆå¯¹åº”è¯­è¨€çš„ç‰¹æ®Šæºä»£ç ï¼Œä¹‹åä¾¿èƒ½è½»æ¾åœ°å‘å„ç§æ•°æ®æµè¯»å†™ç»“æ„åŒ–æ•°æ®ï¼Œåœ¨åæœŸä¿®æ”¹äº†æ•°æ®æ ¼å¼ä¹‹åä¹Ÿä¸ä¼šå½±å“æ—§ç‰ˆæœ¬çš„ç¨‹åºã€‚</p>
<h2 id="0x01-ä¸‹è½½å¹¶ç¼–è¯‘protocol-compiler">0x01 ä¸‹è½½å¹¶ç¼–è¯‘Protocol Compiler</h2>
<p>é¦–å…ˆä¸‹è½½å¯¹åº”çš„<strong><em>Protocol Compiler</em></strong>ï¼Œç”¨äºç¼–è¯‘ <strong><em>.protoæ–‡ä»¶</em></strong> å’Œç”Ÿæˆç»™å®šè¯­è¨€æ“ä½œæ•°æ®æµçš„ä»£ç ã€‚</p>
<blockquote>
<p>ä¹¦å†™è¿™ç¯‡æ–‡ç« æ—¶ï¼ŒProtobufçš„æœ€æ–°ç‰ˆä¸º3.2.0ï¼Œå¯åˆ°å¦‚ä¸‹åœ°å€è·å–ç›¸åº”è¯­è¨€çš„æœ€æ–°ç‰ˆæœ¬ï¼š<a href="https://github.com/google/protobuf/releases" target="_blank" rel="external">https://github.com/google/protobuf/releases</a></p>
</blockquote>
<blockquote>
<p>ç”±äºProtocolç¼–è¯‘å™¨æ˜¯ç”¨C++å¼€å‘çš„ï¼Œéœ€æå‰å®‰è£…makeã€g++ç­‰ç›¸å…³å·¥å…·ï¼Œå®‰è£…æ–¹æ³•è¯·è‡ªè¡ŒGoogleã€‚</p>
</blockquote>
<p>ä¸‹è½½æœ€æ–°ReleaseåŒ…ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget https://github.com/google/protobuf/releases/download/v3.2.0/protobuf-java-3.2.0.tar.gz</div><div class="line">tar -xzf protobuf-java-3.2.0.tar.gz</div><div class="line">cd protobuf-java-3.2.0</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘å¹¶å®‰è£…ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">configure ## ç¼–è¯‘ä¸‰è¿</div><div class="line">make</div><div class="line">make install</div><div class="line"></div><div class="line">protoc --version  ## æµ‹è¯•Protocolç¼–è¯‘å™¨æ˜¯å¦å®‰è£…æˆåŠŸ</div></pre></td></tr></table></figure>
<blockquote>
<p>å…¶ä»–å„å¹³å°çš„è¯¦ç»†å®‰è£…æ–¹æ³•å‚è§protobuf-3.2.0/src/README.md</p>
</blockquote>
<h2 id="0x02-ç¼–è¯‘java-runtime-library">0x02 ç¼–è¯‘Java Runtime Library</h2>
<h3 id="å®‰è£…maven">å®‰è£…Maven</h3>
<p>Protobufçš„Javaé¡¹ç›®é‡‡ç”¨<strong><em>maven</em></strong>è¿›è¡Œç®¡ç†ï¼Œå…ˆå®‰è£…mavenï¼Œè‹¥å·²æœ‰mavenç¯å¢ƒå¿½ç•¥æ­¤æ­¥éª¤ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">brew install maven ## ä½¿ç”¨brewè¿›è¡Œå®‰è£…</div><div class="line"></div><div class="line">mvn test ## å®‰è£…å®Œmavenåæµ‹è¯•</div></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨mavenå®‰è£…ä¾èµ–å¹¶æ‰“åŒ…">ä½¿ç”¨mavenå®‰è£…ä¾èµ–å¹¶æ‰“åŒ…</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd protobuf-3.2.0/java/</div><div class="line">mvn install</div><div class="line">mvn package</div></pre></td></tr></table></figure>
<h3 id="é…ç½®classpath">é…ç½®CLASSPATH</h3>
<p>å®Œæˆä¸Šè¿°æ­¥éª¤åå°†ä¼šåœ¨protobuf-3.2.0/java/core/targetç›®å½•ç”Ÿæˆprotobuf-java-3.2.0.jaråŒ…ï¼Œæˆ‘ä»¬å°†protobuf-java-3.2.0.jaråŠ å…¥åˆ°CLASSPATHä¸­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">export CLASSPATH=&#123;PATH_TO_JARBALL&#125;/protobuf-3.2.0/java/core/target/protobuf-java-3.2.0.jar:$CLASSPATH  ## è¯·ä¿®æ”¹&#123;PATH_TO_JARBALL&#125;ç›®å½•</div><div class="line"></div><div class="line">echo &apos;CLASSPATH=&#123;PATH_TO_JARBALL&#125;/protobuf-3.2.0/java/core/target/protobuf-java-3.2.0.jar:$CLASSPATH&apos; &gt; ~/.profile  ## ä¹Ÿå¯å°†ä¸Šè¿°ä»£ç åŠ å…¥~/.profileæ–‡ä»¶ä¸­</div><div class="line">source ~/.profile</div></pre></td></tr></table></figure>
<p>åˆ°æ­¤å°±å®Œæˆäº†å‰ç½®ä¾èµ–çš„å®‰è£…ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœŸæ­£è®¤è¯†protobufã€‚</p>
<h2 id="0x03-ç¼–è¯‘å¹¶è¿è¡Œç¤ºä¾‹">0x03 ç¼–è¯‘å¹¶è¿è¡Œç¤ºä¾‹</h2>
<p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ç¼–è¯‘ç¤ºä¾‹ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd protobuf-3.2.0/examples/</div><div class="line">make java</div></pre></td></tr></table></figure>
<p>å¦‚æœä¸€åˆ‡æ­£å¸¸å°†ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆ <strong>add_person_java</strong> å’Œ <strong>list_people_java</strong> ä¸¤ä¸ªshellè„šæœ¬ï¼Œå…¶ä¸­ <strong>add_person_java</strong> ç”¨äºæ·»åŠ äººå‘˜ä¿¡æ¯å¹¶å­˜å‚¨åˆ°æ–‡ä»¶ä¸­ï¼Œ<strong>list_people_java</strong> ä»æ–‡ä»¶ä¸­è¯»å–äººå‘˜ä¿¡æ¯ã€‚</p>
<p>æ‰§è¡Œadd_person_javaè„šæœ¬å½•å…¥ä¸€äº›ä¿¡æ¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">sh ./add_person_java</div><div class="line">Usage:  AddPerson ADDRESS_BOOK_FILE</div><div class="line"></div><div class="line">sh ./add_person_java ./person.data</div><div class="line">./person.data: File not found.  Creating a new file.</div><div class="line">Enter person ID: 1</div><div class="line">Enter name: Nemo</div><div class="line">Enter email address (blank for none): foo@gmail.com</div><div class="line">Enter a phone number (or leave blank to finish): 18012345678</div><div class="line">Is this a mobile, home, or work phone? mobile</div><div class="line">Enter a phone number (or leave blank to finish): 86260000</div><div class="line">Is this a mobile, home, or work phone? home</div><div class="line">Enter a phone number (or leave blank to finish):</div></pre></td></tr></table></figure>
<p>ç¨‹åºå°†ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆ <strong><em>person.data</em></strong> æ–‡ä»¶ï¼Œè¿™ä¸ªå°±æ˜¯é‡‡ç”¨protobufç»“æ„åŒ–ä¹‹åå­˜å‚¨çš„æ•°æ®æ–‡ä»¶ã€‚
æ‰§è¡Œlist_people_javaè„šæœ¬æŸ¥çœ‹ä¹‹å‰å½•å…¥çš„æ•°æ®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">sh ./list_people_java ./person.data</div><div class="line">Person ID: 1</div><div class="line">  Name: Nemo</div><div class="line">  E-mail address: foo@gmail.com</div><div class="line">  Mobile phone #: 18012345678</div><div class="line">  Home phone #: 86260000</div></pre></td></tr></table></figure>
<h2 id="0x04-ç¤ºä¾‹ä»£ç ç®€æ">0x04 ç¤ºä¾‹ä»£ç ç®€æ</h2>
<p>ä¸Šé¢æˆ‘ä»¬å®Œæ•´çš„æ¼”ç¤ºäº†Protobufå°†ç»“æ„åŒ–æ•°æ®å†™å…¥æ–‡ä»¶å’Œä»æ–‡ä»¶ä¸­è¯»å–ç»“æ„åŒ–æ•°æ®çš„ç¤ºä¾‹ï¼Œé‚£ä¹ˆè¿™è¿‡ç¨‹æ˜¯å¦‚ä½•å®Œæˆçš„å‘¢ï¼Ÿ</p>
<p>ç¤ºä¾‹ä¸­ä½¿ç”¨äº† <strong><em>addressbook.proto</em></strong> æ–‡ä»¶å®šä¹‰äº†ç›¸åº”çš„åŒ…åã€ç±»åã€ä»¥åŠPersonå’ŒAddressBookä¸¤ç§åè®®ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> tutorial;</div><div class="line"></div><div class="line">option java_package = <span class="string">"com.example.tutorial"</span>;</div><div class="line">option java_outer_classname = <span class="string">"AddressBookProtos"</span>;</div><div class="line"></div><div class="line">message Person &#123;</div><div class="line">  string name = <span class="number">1</span>;</div><div class="line">  int32 id = <span class="number">2</span>;  <span class="comment">// Unique ID number for this person.</span></div><div class="line">  string email = <span class="number">3</span>;</div><div class="line"></div><div class="line">  <span class="keyword">enum</span> PhoneType &#123;</div><div class="line">    MOBILE = <span class="number">0</span>;</div><div class="line">    HOME = <span class="number">1</span>;</div><div class="line">    WORK = <span class="number">2</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  message PhoneNumber &#123;</div><div class="line">    string number = <span class="number">1</span>;</div><div class="line">    PhoneType type = <span class="number">2</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  repeated PhoneNumber phones = <span class="number">4</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Our address book file is just one of these.</span></div><div class="line">message AddressBook &#123;</div><div class="line">  repeated Person people = <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Protobufä¼šæ ¹æ® <strong><em>addressbook.proto</em></strong> æ–‡ä»¶ä¸­çš„å†…å®¹ç”Ÿæˆç›¸åº”çš„java classï¼Œå³protobuf-3.2.0/examples/com/example/tutorial/AddressBookProtos.javaæ–‡ä»¶ï¼Œæ­¤AddressBookProtosç±»åŒ…å«äº†ä¸€ç³»åˆ—Personå’ŒAddressBookç±»çš„æ“ä½œï¼Œç”¨äºè¯»å–å’Œå†™å…¥æ•°æ®ï¼Œå¯ä»¥ç†è§£ä¸ºProtobufæ ¹æ®å®šä¹‰çš„æ•°æ®ç»“æ„å°è£…çš„æ•°æ®æ“ä½œã€‚</p>
<p><strong><em>add_person</em></strong> ä¸»è¦æ˜¯å°†ç”¨æˆ·è¾“å…¥å­˜å‚¨åˆ°æ–‡ä»¶ï¼ŒaddPeople()æ–¹æ³•å¢åŠ peopleæ•°æ®ï¼Œbuild()æ–¹æ³•å°†æ•°æ®åºåˆ—åŒ–ï¼Œæ ¸å¿ƒä»£ç ç‰‡æ®µï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">AddressBook.Builder addressBook = AddressBook.newBuilder();</div><div class="line"></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  FileInputStream input = <span class="keyword">new</span> FileInputStream(args[<span class="number">0</span>]);</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    addressBook.mergeFrom(input);</div><div class="line">  &#125; <span class="keyword">finally</span> &#123;</div><div class="line">    <span class="keyword">try</span> &#123; input.close(); &#125; <span class="keyword">catch</span> (Throwable ignore) &#123;&#125;</div><div class="line">  &#125;</div><div class="line">&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">  System.out.println(args[<span class="number">0</span>] + <span class="string">": File not found.  Creating a new file."</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">addressBook.addPeople(</div><div class="line">  PromptForAddress(<span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in)),</div><div class="line">                   System.out));</div><div class="line"></div><div class="line">FileOutputStream output = <span class="keyword">new</span> FileOutputStream(args[<span class="number">0</span>]);</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  addressBook.build().writeTo(output);</div><div class="line">&#125; <span class="keyword">finally</span> &#123;</div><div class="line">  output.close();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong><em>list_people</em></strong> ä»æ–‡ä»¶ä¸­è¯»å–å·²åºåˆ—åŒ–çš„äºŒè¿›åˆ¶æ•°æ®ï¼ŒgetPeopleList()è·å–peopleåˆ—è¡¨æ•°æ®ï¼ŒgetId()å’ŒgetName()ä¸ºè·å–å±æ€§å€¼æ–¹æ³•ï¼Œæ ¸å¿ƒä»£ç ç‰‡æ®µï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (Person person: addressBook.getPeopleList()) &#123;</div><div class="line">  System.out.println(<span class="string">"Person ID: "</span> + person.getId());</div><div class="line">  System.out.println(<span class="string">"  Name: "</span> + person.getName());</div><div class="line">  <span class="keyword">if</span> (!person.getEmail().isEmpty()) &#123;</div><div class="line">    System.out.println(<span class="string">"  E-mail address: "</span> + person.getEmail());</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (Person.PhoneNumber phoneNumber : person.getPhonesList()) &#123;</div><div class="line">    <span class="keyword">switch</span> (phoneNumber.getType()) &#123;</div><div class="line">      <span class="keyword">case</span> MOBILE:</div><div class="line">        System.out.print(<span class="string">"  Mobile phone #: "</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">case</span> HOME:</div><div class="line">        System.out.print(<span class="string">"  Home phone #: "</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">case</span> WORK:</div><div class="line">        System.out.print(<span class="string">"  Work phone #: "</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">    System.out.println(phoneNumber.getNumber());</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="0x05-æ€»ç»“">0x05 æ€»ç»“</h2>
<p>è™½ç„¶Protobufç›¸æ¯”äºXMLå’ŒJsonï¼Œå…¶å¯è¯»æ€§å·®ã€ç¼ºä¹è‡ªæˆ‘æè¿°ï¼Œåœ¨é€šç”¨æ€§ä¸Šä¹Ÿä¸åŠåä¸¤è€…æ™®åŠï¼Œä½†å®ƒå…·æœ‰æ›´é«˜çš„æ•ˆç‡ï¼Œä½“ç§¯æ›´å°ï¼Œå¹¶ä¸”èƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆå¯¹åº”è¯­è¨€çš„ç‰¹æ®Šæºä»£ç ä¾¿äºå¼€å‘ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[é¸¡å¹´å¤§å‰]]></title>
      <url>https://blog.ijita.me/2017/01/27/2017dajiba/</url>
      <content type="html"><![CDATA[<h3 id="hello-2017">Hello, 2017</h3>
<p>2017å¹´æ­£å¼åŠ å…¥Github Pagesï¼Œå¼€å§‹ç”¨Markdownå†™åšå®¢äº†ï¼Œç›¸æ¯”Wordpressï¼Œé™¤äº†ç®€ä¾¿è¿˜æ˜¯ç®€ä¾¿ã€‚</p>
<h3 id="æ¢è®¨å’Œå­¦ä¹ ">æ¢è®¨å’Œå­¦ä¹ </h3>
<p>ä»¥åå°†åœ¨åšå®¢å†…æ¢è®¨å’Œå­¦ä¹ ä»¥ä¸‹å‡ æ–¹é¢çš„å†…å®¹ï¼š</p>
<blockquote>
<ol>
<li>äººå·¥æ™ºèƒ½ (Artificial Intelligence)</li>
<li>å¤§æ•°æ® (Big Data)</li>
<li>ç‰©è”ç½‘ (Internet of Things)</li>
</ol>
</blockquote>
<h3 id="2017å¹´çš„ä¸‰ä¸ªç›®æ ‡">2017å¹´çš„ä¸‰ä¸ªç›®æ ‡</h3>
<blockquote>
<ol>
<li>æ‘†è„±é©¾ç…§æœ¬æœ¬æ—</li>
<li>æ±‚å©šå¹¶ä¸”æŠŠç»“å©šè¯æ‰¯äº†</li>
<li>å¸¦ä¸Šå¦¹çº¸å‡ºå›½æ—…æ¸¸</li>
</ol>
</blockquote>
<p><strong>é‚£å°±ç¥æˆ‘ğŸ¥å¹´å¤§å‰å§ï¼</strong></p>
]]></content>
    </entry>
    
  
  
</search>
